FROM mcr.microsoft.com/dotnet/sdk:8.0
WORKDIR /app

# Copy project files first for better caching
COPY *.csproj ./
COPY tests/Api.Tests/*.csproj ./tests/Api.Tests/
RUN dotnet restore ./tests/Api.Tests/Api.Tests.csproj

# Copy all source code
COPY . ./

# Run tests
ENTRYPOINT ["dotnet", "test", "./tests/Api.Tests/Api.Tests.csproj", "--no-restore", "--logger:console;verbosity=detailed"]
